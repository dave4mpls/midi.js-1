!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("MIDI",[],t):"object"==typeof exports?exports.MIDI=t():e.MIDI=t()}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=17)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={},e.exports=t.default},function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{default:e}}(n(0));!function(){var e=r.default.WebMIDI={api:"webmidi"};e.send=function(t,n){if(n>0)setTimeout(function(){e.send(t)},1e3*n);else for(var o=0;o<e.output.length;o++)if(e.output[o])e.output[o].send(t);else{var a=15&t[0];switch(240&t[0]){case 128:r.default.noteOff(a,t[1],0);break;case 144:r.default.noteOn(a,t[1],t[2],0);break;case 0:break;case 176:123==t[1]&&r.default.stopAllNotes();break;case 192:r.default.programChange(a,t[1],0);break;case 224:r.default.pitchBend(a,t[1],0)}}},e.setController=function(t,n,r,o){t&=15,e.send([t,n,r],o)},e.setVolume=function(t,n,r){t&=15,e.send([176+t,7,n],r)},e.programChange=function(t,n,r){t&=15,e.send([192+t,n],r)},e.pitchBend=function(t,n,r){t&=15,e.send([224+t,n],r)},e.noteOn=function(t,n,r,o){t&=15,e.send([144+t,n,r],o)},e.noteOff=function(t,n,r){t&=15,e.send([128+t,n,0],r)},e.chordOn=function(t,n,r,o){for(var a=0;a<n.length;a++){var i=n[a];e.send([144+t,i,r],o)}},e.chordOff=function(t,n,r){for(var o=0;o<n.length;o++){var a=n[o];e.send([128+t,a,0],r)}},e.stopAllNotes=function(){for(var t=0;t<16;t++)e.send([176+t,123,0])},e.getInputs=function(){return e.inputList},e.getOutputs=function(){return e.outputList},e.refreshInputs=function(){return e.inputList=[{id:"internal",name:"On Screen Keyboard"}],e.inputHash={internal:null},e.MIDIAccess.inputs.forEach(function(t){e.inputList.push({id:t.id,name:t.name}),e.inputHash[t.id]=t}),e.inputList},e.refreshOutputs=function(){return e.outputList=[{id:"internal",name:"Internal Synthesizer"}],e.outputHash={internal:null},e.MIDIAccess.outputs.forEach(function(t){e.outputList.push({id:t.id,name:t.name}),e.outputHash[t.id]=t}),e.outputList},e.closeAllInputs=function(){e.refreshInputs();for(var t=0;t<e.inputList.length;t++)try{e.inputHash[e.inputList[t].id].close(),e.inputHash[e.inputList[t].id].onmidimessage=void 0}catch(e){}},e.closeAllOutputs=function(){e.refreshOutputs();for(var t=0;t<e.outputList.length;t++)try{e.outputHash[e.outputList[t].id].close()}catch(e){}},e.setOutput=function(t){e.closeAllOutputs(),e.output=[];for(var n=0;n<t.length;n++)e.outputHash.hasOwnProperty(t[n])&&e.output.push(e.outputHash[t[n]]);return!0},e.handleMIDIInput=function(t){e.onmidimessage&&e.onmidimessage(t)},e.setInput=function(t){e.closeAllInputs(),e.input=[];for(var n=0;n<t.length;n++)if(e.inputHash.hasOwnProperty(t[n])){var r=e.inputHash[t[n]];r&&(r.onmidimessage=e.handleMIDIInput),e.input.push(r)}return!0},e.connect=function(t){var n=function(){e.MIDIAccess,e.refreshInputs(),e.refreshOutputs()};e.MIDIAccess?n():navigator.requestMIDIAccess().then(function(t){e.MIDIAccess=t,n()},function(e){if(window.AudioContext)t.api="webaudio";else{if(!window.Audio)return e;t.api="audiotag"}r.default.loadPlugin(t)})}}()},function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{default:e}}(n(0));window.AudioContext&&function(){var e,t=r.default.WebAudio={api:"webaudio"},n={},o={},a=127,i={};t.audioBuffers=i,t.send=function(e,t){},t.setController=function(e,t,n,r){},t.setVolume=function(e,t,n){n?setTimeout(function(){a=t},1e3*n):a=t},t.programChange=function(e,t,n){r.default.channels[e].instrument=t},t.pitchBend=function(e,t,n){r.default.channels[e].pitchBend=t},t.noteOn=function(t,u,s,l){l=l||0;var c=r.default.channels[t];9==t&&(c.instrument=128);var d=c.instrument,f=i[d+""+u];if(f){var p;if(l<e.currentTime&&(l+=e.currentTime),(p=e.createBufferSource()).buffer=f,o){var m=p;for(var v in o)m.connect(o[v].input),m=o[v]}var A=s/127*(a/127)*2-1;return p.connect(e.destination),p.playbackRate.value=1,p.gainNode=e.createGain(),p.gainNode.connect(e.destination),p.gainNode.gain.value=Math.min(1,Math.max(-1,A)),p.connect(p.gainNode),p.start(l||0),n[t+""+u]=p,p}},t.noteOff=function(t,o,a){a=a||0;var u=r.default.channels[t];9==t&&(u.instrument=128);var s=u.instrument,l=i[s+""+o];if(l){a<e.currentTime&&(a+=e.currentTime);var c=n[t+""+o];if(c){if(c.gainNode){var d=c.gainNode.gain;d.linearRampToValueAtTime(d.value,a),d.linearRampToValueAtTime(-1,a+.3)}return c.noteOff?c.noteOff(a+.5):c.stop(a+.5),delete n[t+""+o],c}}},t.chordOn=function(e,n,r,o){for(var a,i={},u=0,s=n.length;u<s;u++)i[a=n[u]]=t.noteOn(e,a,r,o);return i},t.chordOff=function(e,n,r){for(var o,a={},i=0,u=n.length;i<u;i++)a[o=n[i]]=t.noteOff(e,o,r);return a},t.stopAllNotes=function(){for(var t in n){var r=0;r<e.currentTime&&(r+=e.currentTime);var o=n[t];o.gainNode.gain.linearRampToValueAtTime(1,r),o.gainNode.gain.linearRampToValueAtTime(0,r+.3),o.noteOff?o.noteOff(r+.3):o.stop(r+.3),delete n[t]}},t.setEffects=function(t){if(!e.tunajs)return console.log("Effects module not installed.");for(var n=0;n<t.length;n++){var r=t[n],a=new e.tunajs[r.type](r);a.connect(e.destination),o[r.type]=a}},t.connect=function(n){r.default.setDefaultPlugin(t),t.setContext(e||new(window.AudioContext||window.webkitAudioContext),n.onsuccess)},t.getContext=function(){return e},t.setContext=function(t,n,o,a){e=t,void 0===window.Tuna||e.tunajs||(e.tunajs=new window.Tuna(e));var u=[],s=r.default.keyToNote;for(var l in s)u.push(l);var c=function(e){for(var t in f)if(f[t])return;n&&(n(),n=null)},d=function(t,n,o,a){var u=t[a];u&&(f[n]++,function(t,n,r){if(0===t.indexOf("data:audio")){var o=function(e){for(var t=window.atob(e),n=t.length,r=new Uint8Array(n),o=0;o<n;o++)r[o]=t.charCodeAt(o);return r.buffer}(t.split(",")[1]);e.decodeAudioData(o,n,r)}else{var a=new window.XMLHttpRequest;a.open("GET",t,!0),a.responseType="arraybuffer",a.onload=function(){e.decodeAudioData(a.response,n,r)},a.send()}}(u,function(e){e.id=a;var o=r.default.keyToNote[a];i[n+""+o]=e,0==--f[n]&&(t.isLoaded=!0,c())},function(e){console.error(e)}))},f={};for(var p in r.default.Soundfont){var m=r.default.Soundfont[p];if(!m.isLoaded){var v=r.default.GM.byName[p].number;f[v]=0;for(var A=0;A<u.length;A++)d(m,v,0,u[A])}}setTimeout(c,1)}}()},function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{default:e}}(n(0));window.Audio&&function(){for(var e=r.default.AudioTag={api:"audiotag"},t={},n=127,o=-1,a=[],i=[],u={},s=0;s<12;s++)a[s]=new window.Audio;var l=function(e,t){if(r.default.channels[e]){9==e&&(r.default.channels[e].instrument=128);var s=r.default.channels[e].instrument,l=r.default.GM.byId[s].id;if(t=u[t]){var c=l+""+t.id,d=(o+1)%a.length,f=a[d];if(i[d]=c,!r.default.Soundfont[l])return void(r.default.DEBUG&&console.log("404",l));f.src=r.default.Soundfont[l][t.id],f.volume=n/127,f.play(),o=d}}},c=function(e,t){if(r.default.channels[e]){9==e&&(r.default.channels[e].instrument=128);var n=r.default.channels[e].instrument,s=r.default.GM.byId[n].id;if(t=u[t])for(var l=s+""+t.id,c=0,d=a.length;c<d;c++){var f=(c+o+1)%d,p=i[f];if(p&&p===l)return a[f].pause(),void(i[f]=null)}}};e.audioBuffers=a,e.send=function(e,t){},e.setController=function(e,t,n,r){},e.setVolume=function(e,t){n=t},e.programChange=function(e,t){r.default.channels[e].instrument=t},e.pitchBend=function(e,t,n){},e.noteOn=function(e,n,r,o){var a=t[n];if(u[a])return o?setTimeout(function(){l(e,a)},1e3*o):void l(e,a)},e.noteOff=function(e,t,n){},e.chordOn=function(e,n,r,o){for(var a=0;a<n.length;a++){var i=n[a],s=t[i];if(u[s]){if(o)return setTimeout(function(){l(e,s)},1e3*o);l(e,s)}}},e.chordOff=function(e,n,r){for(var o=0;o<n.length;o++){var a=n[o],i=t[a];if(u[i]){if(r)return setTimeout(function(){c(e,i)},1e3*r);c(e,i)}}},e.stopAllNotes=function(){for(var e=0,t=a.length;e<t;e++)a[e].pause()},e.connect=function(n){for(var o in r.default.setDefaultPlugin(e),r.default.keyToNote)t[r.default.keyToNote[o]]=o,u[o]={id:o};n.onsuccess&&n.onsuccess()}}()},function(e,t,n){"use strict";n(3),n(2),n(1)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.Replayer=function(e,t,n,r){for(var a,i=[],u=r||120,s=!!r,l=e.header.ticksPerBeat,c=0;c<e.tracks.length;c++)i[c]={nextEventIndex:0,ticksToNextEvent:e.tracks[c].length?e.tracks[c][0].deltaTime:null};function d(){for(var t=null,n=null,r=null,o=0;o<i.length;o++)null!=i[o].ticksToNextEvent&&(null==t||i[o].ticksToNextEvent<t)&&(t=i[o].ticksToNextEvent,n=o,r=i[o].nextEventIndex);if(null!=n){var a=e.tracks[n][r];e.tracks[n][r+1]?i[n].ticksToNextEvent+=e.tracks[n][r+1].deltaTime:i[n].ticksToNextEvent=null,i[n].nextEventIndex+=1;for(var u=0;u<i.length;u++)null!=i[u].ticksToNextEvent&&(i[u].ticksToNextEvent-=t);return{ticksToEvent:t,event:a,track:n}}return null}var f=[];return function(){function e(){s||"meta"!==a.event.type||"setTempo"!==a.event.subtype||(u=6e7/a.event.microsecondsPerBeat);var e=0;a.ticksToEvent>0&&(e=a.ticksToEvent/l/(u/60));var n=1e3*e*t||0;f.push([a,n]),a=d()}if(a=d())for(;a;)e()}(),{getData:function(){return o(f)}}};var o=function e(t){if("object"!==(void 0===t?"undefined":r(t)))return t;if(null===t)return t;var n="number"==typeof t.length?[]:{};for(var o in t)n[o]=e(t[o]);return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=0;function n(n){var r=e.charCodeAt(t);return n&&r>127&&(r-=256),t+=1,r}return{eof:function(){return t>=e.length},read:function(n){var r=e.substr(t,n);return t+=n,r},readInt32:function(){var n=(e.charCodeAt(t)<<24)+(e.charCodeAt(t+1)<<16)+(e.charCodeAt(t+2)<<8)+e.charCodeAt(t+3);return t+=4,n},readInt16:function(){var n=(e.charCodeAt(t)<<8)+e.charCodeAt(t+1);return t+=2,n},readInt8:n,readVarInt:function(){for(var e=0;;){var t=n();if(!(128&t))return e+t;e+=127&t,e<<=7}}}},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MidiFile=function(e){var t;function n(e){var t=e.read(4),n=e.readInt32();return{id:t,length:n,data:e.read(n)}}function o(e){var n={};n.deltaTime=e.readVarInt();var r=e.readInt8();if(240==(240&r)){if(255!==r){if(240===r){n.type="sysEx";var o=e.readVarInt();return n.data=e.read(o),n}if(247===r){n.type="dividedSysEx";var a=e.readVarInt();return n.data=e.read(a),n}throw new Error("Unrecognised MIDI event type byte: "+r)}n.type="meta";var i=e.readInt8(),u=e.readVarInt();switch(i){case 0:if(n.subtype="sequenceNumber",2!==u)throw new Error("Expected length for sequenceNumber event is 2, got "+u);return n.number=e.readInt16(),n;case 1:return n.subtype="text",n.text=e.read(u),n;case 2:return n.subtype="copyrightNotice",n.text=e.read(u),n;case 3:return n.subtype="trackName",n.text=e.read(u),n;case 4:return n.subtype="instrumentName",n.text=e.read(u),n;case 5:return n.subtype="lyrics",n.text=e.read(u),n;case 6:return n.subtype="marker",n.text=e.read(u),n;case 7:return n.subtype="cuePoint",n.text=e.read(u),n;case 32:if(n.subtype="midiChannelPrefix",1!==u)throw new Error("Expected length for midiChannelPrefix event is 1, got "+u);return n.channel=e.readInt8(),n;case 47:if(n.subtype="endOfTrack",0!==u)throw new Error("Expected length for endOfTrack event is 0, got "+u);return n;case 81:if(n.subtype="setTempo",3!==u)throw new Error("Expected length for setTempo event is 3, got "+u);return n.microsecondsPerBeat=(e.readInt8()<<16)+(e.readInt8()<<8)+e.readInt8(),n;case 84:if(n.subtype="smpteOffset",5!==u)throw new Error("Expected length for smpteOffset event is 5, got "+u);var s=e.readInt8();return n.frameRate={0:24,32:25,64:29,96:30}[96&s],n.hour=31&s,n.min=e.readInt8(),n.sec=e.readInt8(),n.frame=e.readInt8(),n.subframe=e.readInt8(),n;case 88:if(n.subtype="timeSignature",4!==u)throw new Error("Expected length for timeSignature event is 4, got "+u);return n.numerator=e.readInt8(),n.denominator=Math.pow(2,e.readInt8()),n.metronome=e.readInt8(),n.thirtyseconds=e.readInt8(),n;case 89:if(n.subtype="keySignature",2!==u)throw new Error("Expected length for keySignature event is 2, got "+u);return n.key=e.readInt8(!0),n.scale=e.readInt8(),n;case 127:return n.subtype="sequencerSpecific",n.data=e.read(u),n;default:return n.subtype="unknown",n.data=e.read(u),n}}else{var l;0==(128&r)?(l=r,r=t):(l=e.readInt8(),t=r);var c=r>>4;switch(n.channel=15&r,n.type="channel",c){case 8:return n.subtype="noteOff",n.noteNumber=l,n.velocity=e.readInt8(),n;case 9:return n.noteNumber=l,n.velocity=e.readInt8(),0===n.velocity?n.subtype="noteOff":n.subtype="noteOn",n;case 10:return n.subtype="noteAftertouch",n.noteNumber=l,n.amount=e.readInt8(),n;case 11:return n.subtype="controller",n.controllerType=l,n.value=e.readInt8(),n;case 12:return n.subtype="programChange",n.programNumber=l,n;case 13:return n.subtype="channelAftertouch",n.amount=l,n;case 14:return n.subtype="pitchBend",n.value=l+(e.readInt8()<<7),n;default:throw new Error("Unrecognised MIDI event type: "+c)}}}var a=(0,r.default)(e),i=n(a);if("MThd"!==i.id||6!==i.length)throw new Error("Bad .mid file - header not found");var u=(0,r.default)(i.data),s=u.readInt16(),l=u.readInt16(),c=u.readInt16();if(32768&c)throw new Error("Expressing time division in SMTPE frames is not supported yet");for(var d={formatType:s,trackCount:l,ticksPerBeat:c},f=[],p=0;p<d.trackCount;p++){f[p]=[];var m=n(a);if("MTrk"!==m.id)throw new Error("Unexpected chunk - expected MTrk, got "+m.id);for(var v=(0,r.default)(m.data);!v.eof();){var A=o(v);f[p].push(A)}}return{header:d,tracks:f}};var r=function(e){return e&&e.__esModule?e:{default:e}}(n(6))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})});var o=n(5);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})})},function(e,t,n){"use strict";var r=n(8),o=function(e){return e&&e.__esModule?e:{default:e}}(n(0));!function(){o.default.Player={};var e=o.default.Player;e.currentTime=0,e.endTime=0,e.restart=0,e.playing=!1,e.timeWarp=1,e.startDelay=0,e.BPM=120,e.start=e.resume=function(t){e.currentTime<-1&&(e.currentTime=-1),f(e.currentTime,null,t)},e.pause=function(){var t=e.restart;p(),e.restart=t},e.stop=function(){p(),e.restart=0,e.currentTime=0},e.addListener=function(e){n=e},e.removeListener=function(){n=void 0},e.clearAnimation=function(){e.animationFrameId&&window.cancelAnimationFrame(e.animationFrameId)},e.setAnimation=function(t){var n=0,r=0,o=0;e.clearAnimation(),window.requestAnimationFrame(function a(){if(e.animationFrameId=window.requestAnimationFrame(a),0!==e.endTime){e.playing?(n=o===e.currentTime?r-Date.now():0,n=0===e.currentTime?0:e.currentTime-n,o!==e.currentTime&&(r=Date.now(),o=e.currentTime)):n=e.currentTime;var i=e.endTime,u=n/1e3,l=u/60,c=60*l+(u-60*l),d=i/1e3;d-c<-1||t({now:c,end:d,events:s})}})},e.loadMidiFile=function(t,n,a){try{e.replayer=new r.Replayer((0,r.MidiFile)(e.currentData),e.timeWarp,null,e.BPM),e.data=e.replayer.getData(),e.endTime=d(),o.default.loadPlugin({onsuccess:t,onprogress:n,onerror:a})}catch(e){console.error(e),a&&a(e)}},e.loadFile=function(t,n,r,o){if(e.stop(),-1!==t.indexOf("base64,")){var a=window.atob(t.split(",")[1]);e.currentData=a,e.loadMidiFile(n,r,o)}else{var i=new window.XMLHttpRequest;i.open("GET",t),i.overrideMimeType("text/plain; charset=x-user-defined"),i.onreadystatechange=function(){if(4===this.readyState)if(200===this.status){for(var t=this.responseText||"",a=[],i=t.length,u=String.fromCharCode,s=0;s<i;s++)a[s]=u(255&t.charCodeAt(s));var l=a.join("");e.currentData=l,e.loadMidiFile(n,r,o)}else o&&o("Unable to load MIDI file")},i.send()}},e.getFileInstruments=function(){for(var t={},n={},r=0;r<e.data.length;r++){var a=e.data[r][0].event;if("channel"===a.type){var i=a.channel;switch(a.subtype){case"controller":break;case"programChange":n[i]=a.programNumber;break;case"noteOn":var u=n[i];t[o.default.GM.byId[isFinite(u)?u:i].id]=!0}}}var s=[];for(var l in t)s.push(l);return s};var t,n,a,i=[],u=0,s={},l=function(r,o,a,u,l,c,d){return setTimeout(function(){var u={channel:r,note:o,now:a,end:e.endTime,message:l,velocity:c};128===l?delete s[o]:s[o]=u,n&&n(u),e.currentTime=a,i.shift(),i.length<1e3?f(t,!0):e.currentTime===t&&t<e.endTime&&f(t,!0)},a-u)},c=function(){return"webaudio"===o.default.api?o.default.WebAudio.getContext():(e.ctx={currentTime:0},e.ctx)},d=function(){for(var t=e.data,n=t.length,r=.5,o=0;o<n;o++)r+=t[o][1];return r},f=function(n,r,s){if(e.replayer){var f;r||(void 0===n&&(n=e.restart),e.playing&&p(),e.playing=!0,e.data=e.replayer.getData(),e.endTime=d());var m=0,v=0,A=e.data,h=c(),y=A.length;t=.5;var g=n-e.currentTime;if("webaudio"!==o.default.api){var b=window.performance&&window.performance.now?window.performance.now():Date.now();a=a||b,h.currentTime=(b-a)/1e3}u=h.currentTime;for(var q=0;q<y&&v<100;q++){var w=A[q];if((t+=w[1])<=n)m=t;else{n=t-m;var S=w[0].event;if("channel"===S.type){var T=S.channel,I=o.default.channels[T],M=h.currentTime+(n+g+e.startDelay)/1e3,x=t-m+e.startDelay;switch(S.subtype){case"controller":o.default.setController(T,S.controllerType,S.value,M);break;case"programChange":o.default.programChange(T,S.programNumber,M);break;case"pitchBend":o.default.pitchBend(T,S.value,M);break;case"noteOn":if(I.mute)break;f=S.noteNumber-(e.MIDIOffset||0),i.push({event:S,time:x,source:o.default.noteOn(T,S.noteNumber,S.velocity,M),interval:l(T,f,t+e.startDelay,m-g,144,S.velocity)}),v++;break;case"noteOff":if(I.mute)break;f=S.noteNumber-(e.MIDIOffset||0),i.push({event:S,time:x,source:o.default.noteOff(T,S.noteNumber,M),interval:l(T,f,t,m-g,128,0)})}}}}s&&s(i)}},p=function(){var t=c();for(e.playing=!1,e.restart+=1e3*(t.currentTime-u);i.length;){var r=i.pop();window.clearInterval(r.interval),r.source&&("number"==typeof r.source?window.clearTimeout(r.source):r.source.disconnect(0))}for(var o in s){var a=s[o];144===s[o].message&&n&&n({channel:a.channel,note:a.note,now:a.now,end:a.end,message:128,velocity:a.velocity})}s={}}}()},function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{default:e}}(n(0));r.default.GM=function(e){var t=function(e){return e.replace(/[^a-z0-9 ]/gi,"").replace(/[ ]/g,"_").toLowerCase()},n={byName:{},byId:{},byCategory:{},drumByNote:{36:"Bass Drum 1",37:"Side Stick",38:"Acoustic Snare",39:"Hand Clap",40:"Electric Snare",41:"Low Floor Tom",42:"Closed Hi Hat",43:"High Floor Tom",44:"Pedal Hi-Hat",45:"Low Tom",46:"Open Hi-Hat",47:"Low-Mid Tom",48:"Hi-Mid Tom",49:"Crash Cymbal 1",50:"High Tom",51:"Ride Cymbal 1",52:"Chinese Cymbal",53:"Ride Bell",54:"Tambourine",55:"Splash Cymbal",56:"Cowbell",57:"Crash Cymbal 2",58:"Vibraslap",59:"Ride Cymbal 2",60:"Hi Bongo",61:"Low Bongo",62:"Mute Hi Conga",63:"Open Hi Conga",64:"Low Conga",65:"High Timbale",66:"Low Timbale",67:"High Agogo",68:"Low Agogo",69:"Cabasa",70:"Maracas",71:"Short Whistle",72:"Long Whistle",73:"Short Guiro",74:"Long Guiro",75:"Claves",76:"Hi Wood Block",77:"Low Wood Block",78:"Mute Cuica",79:"Open Cuica",80:"Mute Triangle",81:"Open Triangle"}};for(var r in e)for(var o=e[r],a=0,i=o.length;a<i;a++){var u=o[a];if(u){var s=parseInt(u.substr(0,u.indexOf(" ")),10);u=u.replace(s+" ",""),n.byId[--s]=n.byName[t(u)]=n.byCategory[t(r)]={id:t(u),instrument:u,number:s,category:r}}}return n}({Piano:["1 Acoustic Grand Piano","2 Bright Acoustic Piano","3 Electric Grand Piano","4 Honky-tonk Piano","5 Electric Piano 1","6 Electric Piano 2","7 Harpsichord","8 Clavinet"],"Chromatic Percussion":["9 Celesta","10 Glockenspiel","11 Music Box","12 Vibraphone","13 Marimba","14 Xylophone","15 Tubular Bells","16 Dulcimer"],Organ:["17 Drawbar Organ","18 Percussive Organ","19 Rock Organ","20 Church Organ","21 Reed Organ","22 Accordion","23 Harmonica","24 Tango Accordion"],Guitar:["25 Acoustic Guitar (nylon)","26 Acoustic Guitar (steel)","27 Electric Guitar (jazz)","28 Electric Guitar (clean)","29 Electric Guitar (muted)","30 Overdriven Guitar","31 Distortion Guitar","32 Guitar Harmonics"],Bass:["33 Acoustic Bass","34 Electric Bass (finger)","35 Electric Bass (pick)","36 Fretless Bass","37 Slap Bass 1","38 Slap Bass 2","39 Synth Bass 1","40 Synth Bass 2"],Strings:["41 Violin","42 Viola","43 Cello","44 Contrabass","45 Tremolo Strings","46 Pizzicato Strings","47 Orchestral Harp","48 Timpani"],Ensemble:["49 String Ensemble 1","50 String Ensemble 2","51 Synth Strings 1","52 Synth Strings 2","53 Choir Aahs","54 Voice Oohs","55 Synth Choir","56 Orchestra Hit"],Brass:["57 Trumpet","58 Trombone","59 Tuba","60 Muted Trumpet","61 French Horn","62 Brass Section","63 Synth Brass 1","64 Synth Brass 2"],Reed:["65 Soprano Sax","66 Alto Sax","67 Tenor Sax","68 Baritone Sax","69 Oboe","70 English Horn","71 Bassoon","72 Clarinet"],Pipe:["73 Piccolo","74 Flute","75 Recorder","76 Pan Flute","77 Blown Bottle","78 Shakuhachi","79 Whistle","80 Ocarina"],"Synth Lead":["81 Lead 1 (square)","82 Lead 2 (sawtooth)","83 Lead 3 (calliope)","84 Lead 4 (chiff)","85 Lead 5 (charang)","86 Lead 6 (voice)","87 Lead 7 (fifths)","88 Lead 8 (bass + lead)"],"Synth Pad":["89 Pad 1 (new age)","90 Pad 2 (warm)","91 Pad 3 (polysynth)","92 Pad 4 (choir)","93 Pad 5 (bowed)","94 Pad 6 (metallic)","95 Pad 7 (halo)","96 Pad 8 (sweep)"],"Synth Effects":["97 FX 1 (rain)","98 FX 2 (soundtrack)","99 FX 3 (crystal)","100 FX 4 (atmosphere)","101 FX 5 (brightness)","102 FX 6 (goblins)","103 FX 7 (echoes)","104 FX 8 (sci-fi)"],Ethnic:["105 Sitar","106 Banjo","107 Shamisen","108 Koto","109 Kalimba","110 Bagpipe","111 Fiddle","112 Shanai"],Percussive:["113 Tinkle Bell","114 Agogo","115 Steel Drums","116 Woodblock","117 Taiko Drum","118 Melodic Tom","119 Synth Drum"],"Sound effects":["120 Reverse Cymbal","121 Guitar Fret Noise","122 Breath Noise","123 Seashore","124 Bird Tweet","125 Telephone Ring","126 Helicopter","127 Applause","128 Gunshot"],"Drum Channel":["129 Drums"]}),r.default.getInstrument=function(e){var t=r.default.channels[e];return t&&t.instrument},r.default.setInstrument=function(e,t,n){var o=r.default.channels[e];if(n)return setTimeout(function(){o.instrument=t},n);o.instrument=t},r.default.getMono=function(e){var t=r.default.channels[e];return t&&t.mono},r.default.setMono=function(e,t,n){var o=r.default.channels[e];if(n)return setTimeout(function(){o.mono=t},n);o.mono=t},r.default.getOmni=function(e){var t=r.default.channels[e];return t&&t.omni},r.default.setOmni=function(e,t,n){var o=r.default.channels[e];if(n)return setTimeout(function(){o.omni=t},n);o.omni=t},r.default.getSolo=function(e){var t=r.default.channels[e];return t&&t.solo},r.default.setSolo=function(e,t,n){var o=r.default.channels[e];if(n)return setTimeout(function(){o.solo=t},n);o.solo=t},r.default.channels=function(){for(var e={},t=0;t<16;t++)e[t]={instrument:t,pitchBend:0,mute:!1,mono:!1,omni:!1,solo:!1};return e}(),r.default.keyToNote={},r.default.noteToKey={},function(){for(var e=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],t=21;t<=108;t++){var n=e[t%12]+((t-12)/12>>0);r.default.keyToNote[n]=t,r.default.noteToKey[t]=n}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.request=function(e,t,n,r){"string"==typeof e&&(e={url:e});var o=e.data,a=e.url,i=e.method||(e.data?"POST":"GET"),u=e.format,s=e.headers,l=e.responseType,c=e.withCredentials||!1,d=new window.XMLHttpRequest;if(t=t||e.onsuccess,n=n||e.onerror,r=r||e.onprogress,d.open(i,a,!0),s)for(var f in s)d.setRequestHeader(f,s[f]);else o&&d.setRequestHeader("Content-type","application/x-www-form-urlencoded");return"binary"===u&&d.overrideMimeType&&d.overrideMimeType("text/plain; charset=x-user-defined"),l&&(d.responseType=l),c&&(d.withCredentials="true"),n&&"onerror"in d&&(d.onerror=n),r&&d.upload&&"onprogress"in d.upload&&(o?d.upload.onprogress=function(e){r.call(d,e,e.loaded/e.total)}:d.addEventListener("progress",function(e){var t=0;if(e.lengthComputable)t=e.total;else if(d.totalBytes)t=d.totalBytes;else{var n=parseInt(d.getResponseHeader("Content-Length-Raw"));if(!isFinite(n))return;d.totalBytes=t=n}r.call(d,e,e.loaded/t)})),d.onreadystatechange=function(e){if(4===d.readyState)if(200===d.status||304===d.status||308===d.status){if(t){var r;if("xml"===u)r=e.target.responseXML;else if("text"===u)r=e.target.responseText;else if("json"===u)try{r=JSON.parse(e.target.response)}catch(t){n&&n.call(d,e)}t.call(d,e,r)}}else n&&n.call(d,e)},d.send(o),d}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e,t){try{for(var n=(e=e.split('"').join("").split("'").join("").split("]").join("").split("[").join(".")).split("."),r=n.length,o=t||window,a=0;a<r;a++){var i=n[a];if(null==o[i])return!1;o=o[i]}return!0}catch(e){return!1}},a=function(){return this.loaded={},this.loading={},this};a.prototype.add=function(e){var t=this;"string"==typeof e&&(e={url:e});var n=e.urls;void 0===n&&(n=[{url:e.url,verify:e.verify}]);var a=document.getElementsByTagName("head")[0],i=function(e,n){t.loaded[e.url]||n&&!1===o(n)||(t.loaded[e.url]=!0,t.loading[e.url]&&t.loading[e.url](),delete t.loading[e.url],e.onsuccess&&e.onsuccess(),void 0!==p&&p())},u=!1,s=[],l=function(n){if("string"==typeof n&&(n={url:n,verify:e.verify}),/([\w\d.\[\]'"])$/.test(n.verify)){var o=n.test=n.verify;if("object"===(void 0===o?"undefined":r(o)))for(var l=0;l<o.length;l++)s.push(o[l]);else s.push(o)}if(!t.loaded[n.url]){var d=document.createElement("script");d.onreadystatechange=function(){"loaded"!==this.readyState&&"complete"!==this.readyState||i(n)},d.onload=function(){i(n)},d.onerror=function(){if(u=!0,delete t.loading[n.url],"object"===r(n.test))for(var e in n.test)c(n.test[e]);else c(n.test)},d.setAttribute("type","text/javascript"),d.setAttribute("src",n.url),a.appendChild(d),t.loading[n.url]=function(){}}},c=function(e){for(var t=[],n=0;n<s.length;n++)s[n]!==e&&t.push(s[n]);s=t},d=function t(r){if(r)i(r,r.test);else for(var a=0;a<n.length;a++)i(n[a],n[a].test);for(var l=!0,c=0;c<s.length;c++)!1===o(s[c])&&(l=!1);!e.strictOrder&&l?u?e.error&&e.error():e.onsuccess&&e.onsuccess():setTimeout(function(){t(r)},10)};if(e.strictOrder){var f=-1,p=function r(){if(n[++f]){var o=n[f],a=o.url;t.loading[a]?t.loading[a]=function(){o.onsuccess&&o.onsuccess(),r()}:t.loaded[a]?r():(l(o),d(o))}else u?e.error&&e.error():e.onsuccess&&e.onsuccess()};p()}else for(var m=0;m<n.length;m++)l(n[m]),d(n[m])},t.loadScript=new a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={},o=0,a=function(e){o++;var t=document.body,n=new window.Audio,a=e.split(";")[0];n.id="audio",n.setAttribute("preload","auto"),n.setAttribute("audiobuffer",!0),n.addEventListener("error",function(){t.removeChild(n),r[a]=!1,o--},!1),n.addEventListener("canplaythrough",function(){t.removeChild(n),r[a]=!0,o--},!1),n.src="data:"+e,t.appendChild(n)};t.audioDetect=function(e){if(navigator.requestMIDIAccess)if(Function.prototype.toString.call(navigator.requestMIDIAccess).indexOf("[native code]"))r.webmidi=!0;else for(var t=0;navigator.plugins.length>t;t++)navigator.plugins[t].name.indexOf("Jazz-Plugin")>=0&&(r.webmidi=!0);if(void 0===window.Audio)return e({});r.audiotag=!0,(window.AudioContext||window.webkitAudioContext)&&(r.webaudio=!0);var n=new window.Audio;if(void 0===n.canPlayType)return e(r);var i=n.canPlayType('audio/ogg; codecs="vorbis"');i="probably"===i||"maybe"===i;var u=n.canPlayType("audio/mpeg");if(u="probably"===u||"maybe"===u,i||u){i&&a("audio/ogg;base64,T2dnUwACAAAAAAAAAADqnjMlAAAAAOyyzPIBHgF2b3JiaXMAAAAAAUAfAABAHwAAQB8AAEAfAACZAU9nZ1MAAAAAAAAAAAAA6p4zJQEAAAANJGeqCj3//////////5ADdm9yYmlzLQAAAFhpcGguT3JnIGxpYlZvcmJpcyBJIDIwMTAxMTAxIChTY2hhdWZlbnVnZ2V0KQAAAAABBXZvcmJpcw9CQ1YBAAABAAxSFCElGVNKYwiVUlIpBR1jUFtHHWPUOUYhZBBTiEkZpXtPKpVYSsgRUlgpRR1TTFNJlVKWKUUdYxRTSCFT1jFloXMUS4ZJCSVsTa50FkvomWOWMUYdY85aSp1j1jFFHWNSUkmhcxg6ZiVkFDpGxehifDA6laJCKL7H3lLpLYWKW4q91xpT6y2EGEtpwQhhc+211dxKasUYY4wxxsXiUyiC0JBVAAABAABABAFCQ1YBAAoAAMJQDEVRgNCQVQBABgCAABRFcRTHcRxHkiTLAkJDVgEAQAAAAgAAKI7hKJIjSZJkWZZlWZameZaouaov+64u667t6roOhIasBACAAAAYRqF1TCqDEEPKQ4QUY9AzoxBDDEzGHGNONKQMMogzxZAyiFssLqgQBKEhKwKAKAAAwBjEGGIMOeekZFIi55iUTkoDnaPUUcoolRRLjBmlEluJMYLOUeooZZRCjKXFjFKJscRUAABAgAMAQICFUGjIigAgCgCAMAYphZRCjCnmFHOIMeUcgwwxxiBkzinoGJNOSuWck85JiRhjzjEHlXNOSuekctBJyaQTAAAQ4AAAEGAhFBqyIgCIEwAwSJKmWZomipamiaJniqrqiaKqWp5nmp5pqqpnmqpqqqrrmqrqypbnmaZnmqrqmaaqiqbquqaquq6nqrZsuqoum65q267s+rZru77uqapsm6or66bqyrrqyrbuurbtS56nqqKquq5nqq6ruq5uq65r25pqyq6purJtuq4tu7Js664s67pmqq5suqotm64s667s2rYqy7ovuq5uq7Ks+6os+75s67ru2rrwi65r66os674qy74x27bwy7ouHJMnqqqnqq7rmarrqq5r26rr2rqmmq5suq4tm6or26os67Yry7aumaosm64r26bryrIqy77vyrJui67r66Ys67oqy8Lu6roxzLat+6Lr6roqy7qvyrKuu7ru+7JuC7umqrpuyrKvm7Ks+7auC8us27oxuq7vq7It/KosC7+u+8Iy6z5jdF1fV21ZGFbZ9n3d95Vj1nVhWW1b+V1bZ7y+bgy7bvzKrQvLstq2scy6rSyvrxvDLux8W/iVmqratum6um7Ksq/Lui60dd1XRtf1fdW2fV+VZd+3hV9pG8OwjK6r+6os68Jry8ov67qw7MIvLKttK7+r68ow27qw3L6wLL/uC8uq277v6rrStXVluX2fsSu38QsAABhwAAAIMKEMFBqyIgCIEwBAEHIOKQahYgpCCKGkEEIqFWNSMuakZM5JKaWUFEpJrWJMSuaclMwxKaGUlkopqYRSWiqlxBRKaS2l1mJKqcVQSmulpNZKSa2llGJMrcUYMSYlc05K5pyUklJrJZXWMucoZQ5K6iCklEoqraTUYuacpA46Kx2E1EoqMZWUYgupxFZKaq2kFGMrMdXUWo4hpRhLSrGVlFptMdXWWqs1YkxK5pyUzDkqJaXWSiqtZc5J6iC01DkoqaTUYiopxco5SR2ElDLIqJSUWiupxBJSia20FGMpqcXUYq4pxRZDSS2WlFosqcTWYoy1tVRTJ6XFklKMJZUYW6y5ttZqDKXEVkqLsaSUW2sx1xZjjqGkFksrsZWUWmy15dhayzW1VGNKrdYWY40x5ZRrrT2n1mJNMdXaWqy51ZZbzLXnTkprpZQWS0oxttZijTHmHEppraQUWykpxtZara3FXEMpsZXSWiypxNhirLXFVmNqrcYWW62ltVprrb3GVlsurdXcYqw9tZRrrLXmWFNtBQAADDgAAASYUAYKDVkJAEQBAADGMMYYhEYpx5yT0ijlnHNSKucghJBS5hyEEFLKnINQSkuZcxBKSSmUklJqrYVSUmqttQIAAAocAAACbNCUWByg0JCVAEAqAIDBcTRNFFXVdX1fsSxRVFXXlW3jVyxNFFVVdm1b+DVRVFXXtW3bFn5NFFVVdmXZtoWiqrqybduybgvDqKqua9uybeuorqvbuq3bui9UXVmWbVu3dR3XtnXd9nVd+Bmzbeu2buu+8CMMR9/4IeTj+3RCCAAAT3AAACqwYXWEk6KxwEJDVgIAGQAAgDFKGYUYM0gxphhjTDHGmAAAgAEHAIAAE8pAoSErAoAoAADAOeecc84555xzzjnnnHPOOeecc44xxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY0wAwE6EA8BOhIVQaMhKACAcAABACCEpKaWUUkoRU85BSSmllFKqFIOMSkoppZRSpBR1lFJKKaWUIqWgpJJSSimllElJKaWUUkoppYw6SimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaVUSimllFJKKaWUUkoppRQAYPLgAACVYOMMK0lnhaPBhYasBAByAwAAhRiDEEJpraRUUkolVc5BKCWUlEpKKZWUUqqYgxBKKqmlklJKKbXSQSihlFBKKSWUUkooJYQQSgmhlFRCK6mEUkoHoYQSQimhhFRKKSWUzkEoIYUOQkmllNRCSB10VFIpIZVSSiklpZQ6CKGUklJLLZVSWkqpdBJSKamV1FJqqbWSUgmhpFZKSSWl0lpJJbUSSkklpZRSSymFVFJJJYSSUioltZZaSqm11lJIqZWUUkqppdRSSiWlkEpKqZSSUmollZRSaiGVlEpJKaTUSimlpFRCSamlUlpKLbWUSkmptFRSSaWUlEpJKaVSSksppRJKSqmllFpJKYWSUkoplZJSSyW1VEoKJaWUUkmptJRSSymVklIBAEAHDgAAAUZUWoidZlx5BI4oZJiAAgAAQABAgAkgMEBQMApBgDACAQAAAADAAAAfAABHARAR0ZzBAUKCwgJDg8MDAAAAAAAAAAAAAACAT2dnUwAEAAAAAAAAAADqnjMlAgAAADzQPmcBAQA="),u&&a("audio/mpeg;base64,/+MYxAAAAANIAUAAAASEEB/jwOFM/0MM/90b/+RhST//w4NFwOjf///PZu////9lns5GFDv//l9GlUIEEIAAAgIg8Ir/JGq3/+MYxDsLIj5QMYcoAP0dv9HIjUcH//yYSg+CIbkGP//8w0bLVjUP///3Z0x5QCAv/yLjwtGKTEFNRTMuOTeqqqqqqqqqqqqq/+MYxEkNmdJkUYc4AKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq");var s=(new Date).getTime(),l=window.setInterval(function(){var t=(new Date).getTime();o&&!(t-s>5e3)||(window.clearInterval(l),e(r))},1)}else e(r)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(13);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})});var o=n(12);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var a=n(11);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})})},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(14),a=function(e){return e&&e.__esModule?e:{default:e}}(n(0));a.default.Soundfont={},a.default.DEBUG=!0,a.default.USE_XHR=!0,a.default.soundfontUrl="./soundfont/",a.default.loadPlugin=function(e){"function"==typeof e&&(e={onsuccess:e}),a.default.soundfontUrl=e.soundfontUrl||a.default.soundfontUrl,(0,o.audioDetect)(function(t){var n=window.location.hash,r="";if(a.default.supports=t,t[e.api]?r=e.api:t[n.substr(1)]?r=n.substr(1):window.AudioContext?r="webaudio":window.Audio&&(r="audiotag"),t.webmidi&&i.webmidi&&(a.default.__api="webmidi",a.default.__audioFormat=t["audio/ogg"]?"ogg":"mp3",a.default.supports=t,a.default.loadResource(e)),i[r]){var o;o=e.targetFormat?e.targetFormat:t["audio/ogg"]?"ogg":"mp3",a.default.__api=r,a.default.__audioFormat=o,a.default.supports=t,a.default.loadResource(e)}})},a.default.loadResource=function(e){var t=e.instruments||e.instrument||["acoustic_grand_piano","drums"];"object"!==(void 0===t?"undefined":r(t))&&(t=t||0===t?[t]:[]);for(var n=0;n<t.length;n++){var o=t[n];o===+o&&a.default.GM.byId[o]&&(t[n]=a.default.GM.byId[o].id)}e.format=a.default.__audioFormat,e.instruments=t,i[a.default.__api](e)};var i={webmidi:function(e){a.default.WebMIDI.connect(e)},audiotag:function(e){u(e,"AudioTag")},webaudio:function(e){u(e,"WebAudio")}},u=function(e,t){for(var n=e.format,r=e.instruments,o=e.onprogress,i=e.onerror,u=r.length,l=u,c=function(){--l||(o&&o("load",1),a.default[t].connect(e))},d=0;d<u;d++){var f=r[d];a.default.Soundfont[f]?c():s(r[d],n,function(e,t){o&&o("load",t/u+(u-l)/u,f)},function(){c()},i)}},s=function(e,t,n,r,i){var u=a.default.soundfontUrl+e+"-"+t+".js";a.default.USE_XHR?(0,o.request)({url:u,format:"text",onerror:i,onprogress:n,onsuccess:function(e,t){var n=document.createElement("script");n.language="javascript",n.type="text/javascript",n.text=t,document.body.appendChild(n),r()}}):o.loadScript.add({url:u,verify:'root.Soundfont["'+e+'"]',onerror:i,onsuccess:function(){r()}})};a.default.setDefaultPlugin=function(e){for(var t in e)a.default[t]=e[t]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return e&&e.__esModule?e:{default:e}}(n(0));n(15),n(10),n(9),n(4),window.MIDI=r.default,t.default=r.default,e.exports=t.default},function(e,t,n){e.exports=n(16)}])});